默认路径:
	D:\MCU51\

适用于周立功公司的DP51实验板

Version:MS1.01-2003.7.17

	修改:增加ASCII.C的一个ASCI码(7F),用于虚拟按键用


Version:MS1.10-2003.9.14

	更改系统结构，便于打包


Version:MS1.11-2003.9.15

	统一标准风格。


Version:MS1.21-2003.9.29

	修改UART串口的命令解析程序，修改RTC的pcf8563中断部分。


Version:MS1.22-2003.10.4

	精简IIC和smart_timer代码,添加define.h的宏定义。


Version:MS1.23-2003.10.7

	修改system.c里的消息堆栈的宏定义


Version:MS1.24-2003.11.5

	增加ii.c函数,支持对eeprom的打包
	
Version:MS1.25-2004.3.7
	增加由PLD或者GPIO输出的模拟UART，在12MHz，6个CLOCK下速度为57.6K

Version:MS1.26-2004.12.13
	增加消息的优先级功能，消息类型的前4位为消息的优先级，后4位为消息的类型

Version:MS1.27-2005.1.2
	精简了内核，增强了串口函数，并在define.h里增加了宏定义



/**************************************************************************/
Version:MS2 版本升级说明：
	基于DP51板子开发的McuSystem获得了比较大的成功，但也表现出他的一些不足，
	比如它的一些功能对目前开发来说没什么意思，而一些很实际的功能却没有，还有程序上也要有所完善。
	为此，我们专门开发了一块MCU+PLD板子，我们把它叫做MS2，它带有USB，nandflash，PLD，支持ISP，
	相应的我们针对	这个板子发布一个新的软件版本:MS2，以前的可以认为是MS1。此版本今后将集体开发
	整合，而不再是我一个人开发，所	以在上面开发的每一个人都将有代号，而且这个版本的发布和管理权
	将由我来负责或者由我授权，别人未经许可无权发布新版本。

	个人代号:
	王绍伟:wangsw



Version:MS2.00-2005.6.2


/***************************************************************************/
Version:MS3 版本升级说明：
	2005年到2007年，基于MS2版本，主要做了一些推广工作，并且把MS2作为华禹深圳研发中心软件招聘的面试软件，
	也是公司内部嵌入式的培训软件，同时基于此版本，开发了一些项目，比如温度控制设备，步进电机实验板等。

	这次版本的升级基于这两年来用户对此版本的一些问题的反应，以及自己对软件基础的加深所致，
	主要将提供一个跟主流比较接近的编程风格，包括函数接口和函数库等，一些函数细节也将加以改进。

Version:MS3.00-2007.3.11

/**************************************************************************/
Version:MS3.10-2011.1.30版本说明
	MS3.10将用于一个高频电源设备，要求非常可靠，结合自己应用及爱好者使用报告，感觉MS3.00版本在长时间运行中
	可能出现不稳定，特分析消息处理及软件定时器的开关中断问题，发现存在bug，主要是关中断处理可能存在异常。
	同时发现用位操作在特定情况下会出现问题，尤其是对EA的保存，特改成了U8来操作，在Keil下做长时间模拟，未发现异常。
	此外还修正了一个定时器，计时器说明错误。
	
/**************************************************************************/
Version:MS3.20-2011.2.3版本说明
	MS3.20增加了GUI,主要采用了一个函数指针变量代替了复杂的状态机，简洁明了，并且一个界面只需要两个函数概括，
	一个显示的内容，一个是这个界面下的处理函数。本版本原计划改写一个printf函数，因为Keil自带printf资源占用太高，
	但没想到，自己写的性能不如库里的，资源占用还更高，只好放弃，本版本支持标准printf函数。




文件说明: boot.c是程序的入口，初始化后不停的读取消息，并处理消息
	system.c为系统内核，他提供了消息机制(msg_queue_in和msg_queue_out)和系统节拍Timer2Server， 并调用例行程序 routine.c
		处理按键，数码管等。
	define.h为一些常用的宏定义，比如打印函数uprintf()，消息的声明，类型的声明 init.c为系统初始化
	interrupt.c为中断一些初始化和外部中断的入口
	led_key.c为led灯，数码管，按键扫描等一些外设
	message.h为消息类型的宏定义
	mmi.c为人机界面接口，用于编写菜单
	putchar.c用于printf函数，修改了原printf的中断处理，改成查询处理
	routine.c为例行程序处理
	timer.c为定时器处理程序
	uart.c为串口初始化及数据处理

	程序的内核为boot.c和system.c,还有define.h 请先看这三个文件，其他的都可以认为是外设，系统的运转是靠消息来运转的。


说明文档

1:    中断响应问题,当在中断关闭时有一个中断过来,则系统会将它保存在中断
	标记位上,当中断开启时才开始执行这个保存在标记位上的中断,所以中断
	系统只能保持一个中断, EA跟各个独立的中断控制位在这个问题上的功能
	是一样的.例子程序为:
	EA=0;				 		//Time=0
	ES=0;
	have Uart interrupt				//Time=1;
	don't execute Uart interrupt;
	EA=1;						//Time=2;
	ES=1;
	execute Uart interrupt;			//Time=3;


2:	串行口的函数调用问题.在用printf函数时,ES = 0,TI必须为1,但本系统为了能用中断
	接收Uart,ES=1,这样必然会跟TI=1产生冲突,也就是不停的中断响应,所以要用
	printf函数,必须得TI=1,ES=0才行.printf调用putchar函数。printf变量参数必须要用U16类型，否则参数传递错误


3:	pdata 似乎不能用于外部声明的变量,data和xdata可以,这个有待于进一步验证

4:	串口通讯问题: 开机时UART会接收到一个不定的数据,这个主要是uart_init引
	起的,要先TI=0,RI=0后REN=1,这个有待进一步的考证.
	
5:	
位变量(U1)有些时候失效，需要加static或者改成U8，这个问题可能是位寄存器占用完了导致的

本人说明：
	本人在中科院半导体所工作半年，在手机设计公司工作两年至今，以前是软件公司师，
	现在为硬件工程师，主要的工作都在底层的硬件设计及手机的多媒体应用。两年前在
	从周立功公司购买了DP51单片机开发板，感觉这个板子挺不错的，并且结合自己在这
	个行业的实际情况，基于DP51编写了这套软件。之后用这套软件为公司，也为很多朋
	友做了一些项目，包括指纹门禁系统，激光器测试系统，激光器老化系统，，轮胎生
	产自动化控制系统。在这些开发过程中，同时教会了他们怎样使用这套系统，一般的
	讲，具有一些C语言基础的，只要1，2天就可以直接上手使用，之后他们自己可以直
	接调试。
	很多朋友都感到这套系统简单易学，性能不错，尤其是它舍弃了对于单片机51来讲是
	华而不实的RTOS，而又不是采用一般大家平常的大循环设计，并且他引入了手机设计中非
	常重要的平台的概念（DP51为其硬件平台），系统的内核类似于RTOS，内部又有消息
	机制，特别灵活，并且支持消息的优先级。
	他们希望我把他推广，今天本人做了一些修改后把他介绍给大家。

McuSystem介绍：
	现在这段时间RTOS非常热，可很多人往往为了用RTOS而用RTOS，其实很多很多的项目
	一般的设计都已经可以了的，RTOS显得有些画蛇添足。对于一般的设计思路，往往要
	做很多的工作，甚至整个软件的结构不知道怎么搭建，McuSystem主要就是解决以上的
	问题提出的，真正为实用服务的一个系统，它全部用C语言编写，结构非常清晰，核心
	是它的消息机制，解决很多普通设计中的一些问题，包括并发事件问题。并且这个消息
	还支持优先级。我相信只要具有一般C语言水平的都能很快的看懂。
	系统用Source Insight做编辑，keil为编译，DPFLASH下载，这个成了标准配置，目录
	建在D:\MCU51\。这个程序是让大家去修改，以适合自己的平台用。
	现在简单的说一下文件的构成:boot.c是入口程序，define.h是一些宏定义，system.c
	是系统内核，包括节拍，消息都在这个里面，routine.c为例行程序，如键盘，数码管
	显示都在这个里面控制，键盘是采用扫描的。

McuSystem面向对象：
	中等规模的系统，代码一般在2，30K，
	初学单片机并且想更上一层楼的，或者有些基础，想减少工作量的。


作者：王绍伟。
2004/12/14


作者近期工作
自2007年更新到MS3版本后，到今天已经4年都没有更新，主要原因是事业太忙了，主要做了以下几件事情:
1:2008年3月创建了一个淘宝店，叫创易电子(http://52edk.taobao.com)，主要销售作者发明的创易电阻电容电感样品本，同时给嵌入式开发人员配单。
2:2008年12月设计开发了第一款手机开发模块(www.huayusoft.com)，及基于他的相关产品，典型的产品为P1220，应用于上海世博会门票检测，上了新闻联播，
同时大量应用于全国的公交一卡通系统及快递物流行业。此款产品技术基于最成熟的MTK手机平台开发。好多高校也基于此开发项目。
3:2010年建立了一个MiQ群，类似QQ群，并且可以直接跟QQ群对接信息，实现容纳上万人的大群以便工程师讨论学习。MiQ还可以挂在各个门户网站，聊天内容导入到论坛上。
4:涉足机械自动化行业及大功率电源行业，目前这一行业利润较高，前景广泛。



MS3 bug反馈方式:
wangsw317@163.com
QQ:26033613


